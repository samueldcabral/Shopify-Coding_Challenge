(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){e.exports=a(46)},23:function(e,t,a){},25:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(15),l=a.n(s),i=(a(23),a(2)),c=a(3),o=a(5),u=a(4),m=a(6),f=(a(25),function(){return r.a.createElement("div",{className:"navbar"},r.a.createElement("h1",{className:"navbar__h1"},"Toronto Waste Lookup"))}),d=a(7),h=function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif",alt:"Loading... Please Wait..."}))},p=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={favs:[],starred:[]},a.getLink=function(e){var t=e.split("<a href=")[1];t=t.split('"')[1];var a=e.split('">')[1];return{link:t,word:a=a.split("</")[0]}},a.convertLink=function(e){for(var t=e.split(""),a=[],n=0;n<t.length;n++)60===t[n].charCodeAt(0)&&97===t[n+1].charCodeAt(0)?a.push({first:n}):62===t[n].charCodeAt(0)&&97===t[n-1].charCodeAt(0)&&a.push({second:n});return a},a.htmlToElements=function(e){var t=document.createElement("template");return t.innerHTML=e,t.content.childNodes},a.htmlToElement=function(e){var t=document.createElement("template");return t.innerHTML=e,t.content},a.sanitizeTxt=function(e){for(var t=e.split(""),a=0,n=0;n<t.length;n++)if(38===t[n].charCodeAt(0)){for(;59!==t[n].charCodeAt(0);)t[n]=0===a?t[n].replace(t[n]," "):t[n].replace(t[n],""),a++,n++;59===t[n].charCodeAt(0)&&(t[n]=t[n].replace(t[n],""))}return t=t.join("").trim()},a.getBoldWords=function(e){for(var t=[],n=[],s=0;s<e.length;s++)if(e[s].includes("<strong>")){for(var l=e[s].split("<strong>"),i=0;i<l.length;i++)if(l[i].includes("</")){var c=l[i].split("</strong>");n.push(c[0])}}else if(e[s].includes("<b>")){for(var o=e[s].split("<b>"),u=0;u<o.length;u++)if(o[u].includes("</")){var m=o[u].split("</b>");n.push(m[0])}}else if(e[s].includes("</a")){for(var f=a.htmlToElement(e[s]).childNodes,d=[],h=0;h<f.length;h++)f[h].innerHTML?d.push(r.a.createElement("a",{href:f[h].href},f[h].innerHTML)):d.push(f[h].textContent);t.push(r.a.createElement("p",null,d))}for(var p=0;p<e.length;p++)if(e[p].includes("<strong>")){var v=e[p].split("<strong>");t.push(r.a.createElement("li",null,v[0],r.a.createElement("strong",null,n[p])))}else if(e[p].includes("<b>")){var _=e[p].split("<b>");t.push(r.a.createElement("li",null,_[0],r.a.createElement("strong",null,n[p])))}else e[p].includes("</a")?console.log("nothing to see here"):t.push(r.a.createElement("li",null,e[p]));return t},a.domParser=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=a.htmlToElements(t.documentElement.textContent),r=a.htmlToElements(n[0].innerHTML),s=(r=Object(d.a)(r)).filter(function(e){return e.innerHTML}).map(function(e){return e.innerHTML}).map(function(e){return a.sanitizeTxt(e)});return a.getBoldWords(s)},a._favoriteItem=function(e,t){if(a.state.starred.filter(function(e){return e.starItem.index===t&&!0===e.starItem.starred}).length>0){var n={index:t,starred:!1},r=a.state.starred.filter(function(e){return e.starItem.index!==t});r=[].concat(Object(d.a)(r),[{starItem:n}]),a.setState({starred:r}),a._unfavoriteItem(e,t)}else{var s={index:t,starred:!0},l=[].concat(Object(d.a)(a.state.starred),[{starItem:s}]),i=[].concat(Object(d.a)(a.state.favs),[{x:e}]);a.setState({starred:l}),a.setState({favs:i})}},a._unfavoriteItem=function(e,t){var n=a.state.favs.filter(function(e){return e.x.index!==t}),r={index:t,starred:!1},s=a.state.starred.filter(function(e){return e.starItem.index!==t});s=[].concat(Object(d.a)(s),[{starItem:r}]),a.setState({starred:s}),a.setState({favs:n})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.itemList,n=t.loading,s=0!==Object.keys(a).length?a.map(function(t,a){t.index=a,t.starred=!1;var n=e.state.starred.filter(function(e){return e.starItem.index===a&&!0===e.starItem.starred});return r.a.createElement("div",{className:"searchResult",key:a},r.a.createElement("span",{className:"searchResult__title"},r.a.createElement("i",{className:n.length>0?"fa fa-star searchResult__icon searchResult__icon--starred":"fa fa-star searchResult__icon","aria-hidden":"true",id:a,onClick:function(){e._favoriteItem(t,a)}}),r.a.createElement("h4",{className:"searchResult__h4"},t.title)),r.a.createElement("ul",{className:"searchResult__ul"},e.domParser(t.body).map(function(e){return r.a.createElement("li",null,e)})))}):"",l=this.state.favs?this.state.favs.map(function(t,a){var n=e.state.starred.filter(function(e){return e.starItem.index===a});return r.a.createElement("div",{className:"searchResult",key:a},r.a.createElement("span",{className:"searchResult__title"},r.a.createElement("i",{className:n.length>0?"fa fa-star searchResult__icon searchResult__icon--starred":"fa fa-star searchResult__icon","aria-hidden":"true",id:a,onClick:function(){e._unfavoriteItem(t.x,t.x.index)}}),r.a.createElement("h4",{className:"searchResult__h4"},t.x.title)),r.a.createElement("ul",{className:"searchResult__ul"},e.domParser(t.x.body).map(function(e){return r.a.createElement("li",null,e)})))}):"";return n?r.a.createElement(h,null):r.a.createElement("div",null,s,r.a.createElement("div",{className:this.state.favs.length>0?"favouritesWrapper":"noFavourites"},r.a.createElement("h2",{className:"favourites__h2"},"Favourites"),l))}}]),t}(n.Component),v=a(16),_=a.n(v),g=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={keyword:"",url:"https://secure.toronto.ca/cc_sr_v1/data/swm_waste_wizard_APR?limit=1000",items:[],loading:null},a._handleSubmit=function(e){e.preventDefault()},a.__handleChange=function(e){var t=e.target.value;""===e.target.value&&setTimeout(function(){a.setState({items:[]})},300),a.setState({keyword:t})},a._handleKeyDown=function(e){13===e.keyCode&&a._performApiCall()},a._performApiCall=function(){var e=a.state.keyword,t=RegExp(e,"g");a.setState({loading:!0}),_.a.get(a.state.url).then(function(e){var n=e.data.filter(function(e){return t.exec(e.title)||t.exec(e.keywords)});a.setState({items:n,loading:!1})})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{className:"search",onSubmit:this._handleSubmit},r.a.createElement("input",{type:"input",className:"search__input",onChange:this.__handleChange,onKeyDown:this._handleKeyDown}),r.a.createElement("span",{onClick:this._performApiCall},r.a.createElement("i",{className:"fas fa-search fa-flip-horizontal search__icon"}))),r.a.createElement(p,{itemList:this.state.items,loading:this.state.loading}))}}]),t}(n.Component),E=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f,null),r.a.createElement(g,null))}}]),t}(n.Component);l.a.render(r.a.createElement(E,null),document.getElementById("root"))}},[[17,2,1]]]);
//# sourceMappingURL=main.fd9e2bda.chunk.js.map